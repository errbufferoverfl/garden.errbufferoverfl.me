<!-- set data/config yaml file based on website language -->
{{ $config := cond (eq $.Site.Language.Lang "en") "config" (printf "config.%s" $.Site.Language.Lang) }}
{{ $data := index $.Site.Data $config }}
{{ $title := "" }}{{ if .Title }}{{ $title = ( printf "%s âœ§ %s" .Title $.Site.Data.config.title ) }}{{ else }}{{ $title = $data.title | default $.Site.Data.config.title }}{{ end }}
<head>
  <!-- Meta tags -->
  <meta charset="UTF-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Configure robots.txt --->
  {{ if hugo.IsProduction | or (eq site.Params.env "production") | and (ne .Params.robotsNoIndex true) }}
  <meta name="robots" content="index, follow">
  {{ else }}
  <meta name="robots" content="noindex, nofollow">
  {{ end }}

  <!-- Configure profile equivalence for identity-consolidation. --->
  {{ range $.Site.Data.config.rel_me }}
  <link rel="me" href="{{ . }}">
  {{ end }}
  {{ if .IsHome }}
  {{ with .Site.Params.keywords }}
  <meta name="keywords" content="{{ range $i, $e := . }}{{ if $i }}, {{ end }}{{ $e }}{{ end }}"/>
  {{ end }}
  {{ else }}
  <meta name="keywords" content="{{ if .Params.keywords }}
    {{ range $i, $e := .Params.keywords }}{{ if $i }}, {{ end }}{{ $e }}{{ end }} {{ else }}
    {{ range $i, $e := .Params.tags }}{{ if $i }}, {{ end }}{{ $e }}{{ end }} {{ end }}"/>
  {{ end }}
  <meta name="description" content="{{ with $.Site.Data.config.description }}{{ . }}{{ else }}{{ if or .IsPage .IsSection }}
  {{ .Summary | default $title }}{{ else }}
  {{ with .Site.Params.description }}{{ . }}{{ end }}{{ end }}{{ end }}">
  <meta name="author" content="{{ if .IsHome }}{{ $.Site.Data.author | default $.Site.Data.config.author }}{{ else }}{{ site.Author.name }}{{ end }}">
  <link rel="canonical" href="{{ if .Params.canonicalURL }} {{ trim .Params.canonicalURL " " }} {{ else }} {{ .Permalink }} {{ end }}" />

  <!-- Opengraph config -->
  {{ template "partials/templates/opengraph.html" . }}
  <!-- Twitter card config -->
  {{ template "partials/templates/twitter_cards.html" . }}
  <!-- JSON Schema config -->
  {{ template "partials/templates/schema_json.html" . }}

  <!--  Hugo Generator -->
  {{ hugo.Generator }}

  <!--  Configure alternative feed types e.g., RSS, JSON -->
  {{ range .AlternativeOutputFormats }}
  {{ printf `
  <link rel="%s" type="%s" href="%s" title="%s"/>
  ` .Rel .MediaType.Type .Permalink $title | safeHTML }}
  {{ end }}

  <!--  Configure alternative translations -->
  {{ range .AllTranslations }}
  <link rel="alternate" hreflang="{{ .Lang }}" href="{{ .Permalink | safeURL }}">
  {{ end }}

  <title>{{ $title }}</title>
  <!-- HTML Favicon -->
  {{ $favicon := $data.favicon  | default $.Site.Data.config.favicon | default (slice (dict "rel" "shortcut icon" "type" "image/png" "href" "/icon.png")) }}
  {{ $type := (printf "%T" $favicon) }}
  {{ if eq $type "string" }}
  {{ $favicon | safeHTML }}
  {{ else }}
  {{ range $favicon }}
  <link rel="{{ .rel }}" {{ if .type }}type="{{ .type }}"{{ end }} {{ if .sizes }}sizes="{{ .sizes }}"{{ end }} href="{{ .href }}" />
  {{ end }}
  {{ end }}

  <!-- CSS Stylesheets and Fonts -->
  {{ $sass := resources.Match "styles/[!_]*.scss" }}
  {{ $css := slice }}
  {{ range $sass }}
  {{ $scss := . | resources.ToCSS (dict "outputStyle" "compressed") }}
  {{ $css = $css | append $scss }}
  {{ end }}

  <!-- SCSS for Callouts -->
  {{ if $data.enableCallouts | default $.Site.Data.config.enableCallouts }}
  {{ $scss := resources.Get "styles/_callouts.scss" | resources.ToCSS (dict "outputStyle" "compressed") }}
  {{ $css = $css | append $scss }}
  {{ end }}

  {{ $finalCss := $css | resources.Concat "styles/styles.css" | resources.Fingerprint "md5" | resources.Minify }}
  <link href="{{ $finalCss.Permalink }}" rel="stylesheet" />

  {{ $lightSyntax := resources.Get "styles/_light_syntax.scss" | resources.ToCSS (dict "outputStyle" "compressed") | resources.Fingerprint "md5" | resources.Minify }}
  <link href="{{ $lightSyntax.Permalink }}" rel="stylesheet" id="theme-link">
</head>
